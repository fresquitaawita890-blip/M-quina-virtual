name: PC_Gamer_Definitiva
on: workflow_dispatch
jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: 1_Preparar_Graficos_y_Red
        run: |
          # Habilitar RDP sin importar el nombre de usuario
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -Value 0
          Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
          # Instalar motor gr√°fico para que Roblox corra fluido
          choco install mesa3d-softpipe -y
          
      - name: 2_Abrir_Tunel_Gamer
        run: |
          choco install ngrok -y
          ngrok config add-authtoken 39eVkh665hfvR3NNdqK6yFbG3B7_5NqkDibvo8CtNxNEkmxwR
          # Forzamos el t√∫nel y esperamos un poco m√°s
          Start-Process ngrok -ArgumentList "tcp 3389"
          Write-Host "Estabilizando conexi√≥n..."
          Start-Sleep -Seconds 45
          
      - name: 3_DATOS_FINALES_DE_CONEXION
        run: |
          $address = (Invoke-RestMethod http://localhost:4040/api/tunnels).tunnels[0].public_url
          $clean = $address -replace "tcp://", ""
          echo "--------------------------------------------------"
          echo "üöÄ PC GAMER LISTA PARA ROBLOX"
          echo "üåê DIRECCION: $clean"
          echo "üë§ USUARIO: runneradmin"
          echo "üîë CLAVE: (No necesita, entra directo)"
          echo "--------------------------------------------------"
          
      - name: 4_Mantener_Viva
        run: Start-Sleep -Seconds 21600
        
